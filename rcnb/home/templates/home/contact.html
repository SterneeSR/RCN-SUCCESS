{% extends "base.html" %}
{% load static %}

{% block title %}Contact Us - RAISE Centre for Nanobiotechnology{% endblock title %}

{% block content %}
<style>
    /* NOTE: It's best practice to move this CSS into a static file 
    (e.g., static/css/contact.css) and link it in your base.html.
    */

    /* Style for the success message overlay from Snippet 1 */
    #success-overlay {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #238636;
        color: white;
        padding: 15px 30px;
        border-radius: 8px;
        z-index: 1000;
        display: none; /* Hidden by default */
        font-weight: 500;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    /* Contact Page Specific Styles from Snippet 3 */
    .contact-page {
        font-family: 'Poppins', sans-serif;
    }

    .contact-wrapper {
        min-height: 100vh;
        position: relative;
    }

    /* Background Video Section */
    .background-container {
        position: absolute;
        inset: 0;
        z-index: 0;
        overflow: hidden;
    }

    .background-video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .video-fallback {
        width: 100%;
        height: 100%;
    }

    .video-fallback img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .background-overlay {
        position: absolute;
        inset: 0;
    }

    .dark .background-overlay {
        background-color: rgba(0, 0, 0, 0.7);
    }

    body:not(.dark) .background-overlay {
        background-color: rgba(255, 255, 255, 0.3);
    }

    /* Nanobiotechnology decorative elements */
    .nano-decoration {
        position: absolute;
        z-index: 10;
        opacity: 0.2;
    }

    .nano-decoration-1 {
        top: 25%;
        right: 2rem;
    }

    .nano-decoration-2 {
        bottom: 33%;
        left: 2rem;
    }

    .nano-dot {
        width: 1.5rem;
        height: 1.5rem;
        border-radius: 50%;
    }

    .nano-purple {
        background-color: var(--nano-purple);
        animation: pulse 3s ease-in-out infinite;
    }

    .nano-orange {
        background-color: var(--nano-orange);
        animation: bounce 2s ease-in-out infinite;
    }

    /* Content Container */
    .content-container {
        position: relative;
        z-index: 20;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem;
    }

    .contact-grid {
        max-width: 96rem;
        width: 100%;
        display: grid;
        grid-template-columns: 1fr;
        gap: 3rem;
    }

    @media (min-width: 1024px) {
        .contact-grid {
            grid-template-columns: 1fr 1fr;
        }
    }

    /* Contact Information */
    .contact-info {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    .dark .contact-info {
        color: #E6E6E6;
    }

    body:not(.dark) .contact-info {
        color: #1f2937;
    }

    .info-header {
        margin-bottom: 2rem;
    }

    .page-title {
        font-size: 3rem;
        margin-bottom: 1.5rem;
        background: linear-gradient(to right, #a855f7, #fb7185);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    @media (min-width: 768px) {
        .page-title {
            font-size: 3.75rem;
        }
    }

    .page-description {
        font-size: 1.25rem;
        line-height: 1.75;
    }

    .dark .page-description {
        color:rgb(16, 15, 15);
    }

    body:not(.dark) .page-description {
        color: #374151;
    }

    /* Contact Details */
    .contact-details {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .contact-item {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        padding: 1rem;
        border-radius: 0.5rem;
        border: 1px solid;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
    }

    .dark .contact-item {
        background-color: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.1);
    }

    body:not(.dark) .contact-item {
        background-color: rgba(0, 0, 0, 0.1);
        border-color: rgba(0, 0, 0, 0.1);
    }

    .contact-icon {
        flex-shrink: 0;
        width: 1.5rem;
        height: 1.5rem;
        margin-top: 0.25rem;
    }

    .mail-icon { color: #a855f7; }
    .phone-icon { color: #fb7185; }
    .location-icon { color: #34d399; }

    .contact-content h3 {
        font-size: 1.125rem;
        margin-bottom: 0.25rem;
    }

    .dark .contact-content h3 { color: #E6E6E6; }
    body:not(.dark) .contact-content h3 { color: #1f2937; }
    .dark .contact-content p { color: #E6E6E6; }
    body:not(.dark) .contact-content p { color: #374151; }

    /* Office Hours */
    .office-hours {
        padding: 1.5rem;
        border-radius: 0.75rem;
        background: linear-gradient(to right, rgba(139, 92, 246, 0.2), rgba(251, 113, 133, 0.2));
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid;
    }

    .dark .office-hours { border-color: rgba(255, 255, 255, 0.1); }
    body:not(.dark) .office-hours { border-color: rgba(0, 0, 0, 0.1); }

    .office-hours h3 {
        font-size: 1.25rem;
        margin-bottom: 1rem;
    }

    .dark .office-hours h3 { color: #E6E6E6; }
    body:not(.dark) .office-hours h3 { color: #1f2937; }

    .hours-list {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .hours-list p { font-size: 0.875rem; }
    .dark .hours-list p { color: #E6E6E6; }
    body:not(.dark) .hours-list p { color: #374151; }

    /* Contact Form Container */
    .contact-form-container {
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        padding: 2rem;
        border-radius: 1rem;
        border: 1px solid;
    }

    .dark .contact-form-container {
        background-color: rgba(0, 0, 0, 0.3);
        border-color: rgba(255, 255, 255, 0.1);
    }

    body:not(.dark) .contact-form-container {
        background-color: rgba(255, 255, 255, 0.7);
        border-color: rgba(0, 0, 0, 0.1);
    }

    .form-title {
        font-size: 1.875rem;
        margin-bottom: 1.5rem;
    }

    .dark .form-title { color: #E6E6E6; }
    body:not(.dark) .form-title { color: #1f2937; }

    /* Contact Form */
    .contact-form {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .form-group { display: flex; flex-direction: column; }

    .form-label {
        margin-bottom: 0.5rem;
        font-weight: 500;
    }

    .dark .form-label { color: #E6E6E6; }
    body:not(.dark) .form-label { color: #374151; }

    .form-input, .form-textarea {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 1px solid;
        border-radius: 0.5rem;
        transition: all 0.3s ease;
        font-family: 'Poppins', sans-serif;
        font-size: 1rem;
    }

    .dark .form-input, .dark .form-textarea {
        background-color: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.2);
        color: #E6E6E6;
    }

    .dark .form-input::placeholder, .dark .form-textarea::placeholder { color: #9ca3af; }

    body:not(.dark) .form-input, body:not(.dark) .form-textarea {
        background-color: rgba(255, 255, 255, 0.9);
        border-color: #d1d5db;
        color: #1f2937;
    }

    body:not(.dark) .form-input::placeholder, body:not(.dark) .form-textarea::placeholder { color: #6b7280; }

    .form-input:focus, .form-textarea:focus {
        outline: none;
        border-color: #a855f7;
        box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
    }

    .form-textarea {
        resize: vertical;
        min-height: 120px;
    }

    /* Submit Button */
    .submit-btn {
        width: 100%;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        border: none;
        font-family: 'Poppins', sans-serif;
        font-weight: 500;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .dark .submit-btn {
        background: linear-gradient(to right, #8b5cf6, #f59e0b);
        color: #E6E6E6;
    }

    .dark .submit-btn:hover { background: linear-gradient(to right, #7c3aed, #d97706); }
    .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn-content { display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
    .loading-spinner { display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
    
    .spinner {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top: 2px solid #ffffff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    
    /* Additional Info */
    .additional-info {
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: 1px solid;
        text-align: center;
    }
    .dark .additional-info { border-color: rgba(255, 255, 255, 0.1); }
    .additional-info p { font-size: 0.875rem; color: #9ca3af; }
    
    /* Map Section */
    .map-section { padding: 4rem 2rem; }
    .dark .map-section { background-color: #0f0f0f; }
    .map-container { max-width: 96rem; margin: 0 auto; }
    
    .map-title {
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 3rem;
    }
    .dark .map-title { color: #E6E6E6; }
    
    .map-placeholder {
        border-radius: 0.75rem;
        padding: 1rem;
        height: 24rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid;
    }
    .dark .map-placeholder { background-color: #1f2937; border-color: #374151; }
    .map-content { text-align: center; }
    .dark .map-icon { color: #9ca3af; }
    .map-icon { margin-bottom: 1rem; }
    .dark .map-text { color: #9ca3af; }
    .map-text { font-size: 1.25rem; margin-bottom: 0.5rem; }
    .dark .map-subtext { color: #6b7280; }
    .map-subtext { font-size: 0.875rem; }
    
    /* Responsive & Animation */
    @media (max-width: 768px) {
        .page-title { font-size: 2.5rem; }
        .contact-grid { gap: 2rem; }
        .contact-form-container { padding: 1.5rem; }
        .nano-decoration { display: none; }
    }
    @keyframes spin { to { transform: rotate(360deg); } }
</style>

<body class="contact-page dark">
    <div class="contact-wrapper">
        <div class="background-container">
            <video class="background-video" autoplay muted loop poster="{% static 'images/video-fallback.jpg' %}">
                <source src="{% static 'images/background-vid.mp4' %}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="background-overlay"></div>
        </div>

        <div class="nano-decoration nano-decoration-1">
            <div class="nano-dot nano-purple"></div>
        </div>
        <div class="nano-decoration nano-decoration-2">
            <div class="nano-dot nano-orange"></div>
        </div>

        <div class="content-container">
            <div class="contact-grid">
                
                <div class="contact-info">
                    <div class="info-header">
                        <h1 class="page-title">Contact Us</h1>
                        <p class="page-description">
                            Get in touch with us to learn more about our nanobiotechnology innovations 
                            and startup incubation programs.
                        </p>
                    </div>

                    <div class="contact-details">
                        <div class="contact-item">
                            <div class="contact-icon mail-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                    <polyline points="22,6 12,13 2,6"/>
                                </svg>
                            </div>
                            <div class="contact-content">
                                <h3>Email</h3>
                                <p>hello@aicraise.com</p>
                            </div>
                        </div>

                        <div class="contact-item">
                            <div class="contact-icon phone-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                </svg>
                            </div>
                            <div class="contact-content">
                                <h3>Phone</h3>
                                <p>77080 19222, 77080 34222</p>
                            </div>
                        </div>

                        <div class="contact-item">
                            <div class="contact-icon location-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                    <circle cx="12" cy="10" r="3"/>
                                </svg>
                            </div>
                            <div class="contact-content">
                                <h3>Address</h3>
                                <p>
                                    AIC Raise Business Incubator,<br>
                                    Rathinam Techzone, Eachanari,<br>
                                    Coimbatore - 641 021.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="office-hours">
                        <h3>Office Hours</h3>
                        <div class="hours-list">
                            <p>Monday - Friday: 9:00 AM - 6:00 PM</p>
                            <p>Saturday: 9:00 AM - 2:00 PM</p>
                            <p>Sunday: Closed</p>
                        </div>
                    </div>
                </div>

                <div class="contact-form-container">
                    <h2 class="form-title">Send us a Message</h2>
                    
                    <form class="contact-form" id="contact-form" method="post" action="{% url 'home:submit_contact_form' %}">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="name" class="form-label">Name *</label>
                            <input type="text" id="name" name="name" placeholder="Enter your Name" required class="form-input">
                        </div>

                        <div class="form-group">
                            <label for="contact_number" class="form-label">Contact Number *</label>
                            <input type="tel" id="contact_number" name="contact_number" pattern="[0-9]{10}" placeholder="Enter your 10-digit number" required class="form-input">
                        </div>

                        <div class="form-group">
                            <label for="email" class="form-label">Email ID *</label>
                            <input type="email" id="email" name="email" placeholder="Enter your Email" required class="form-input">
                        </div>

                        <div class="form-group">
                            <label for="message" class="form-label">Your Message *</label>
                            <textarea id="message" name="message" placeholder="Type your message here..." required rows="5" class="form-textarea"></textarea>
                        </div>

                        <button type="submit" class="submit-btn" id="submit-btn">
                            <span class="btn-content">
                                <svg class="send-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22,2 15,22 11,13 2,9"/>
                                </svg>
                                <span class="btn-text">Send Message</span>
                            </span>
                            <div class="loading-spinner" style="display: none;">
                                <div class="spinner"></div>
                                <span>Sending...</span>
                            </div>
                        </button>
                    </form>

                    <div class="additional-info">
                        <p>We typically respond within 24 hours during business days.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section class="map-section">
        <div class="map-container">
            <h2 class="map-title">Find Us</h2>
            <div class="map-placeholder">
                 <div class="map-content">
                    <div class="map-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                    </div>
                    <p class="map-text">Google Maps Integration Here</p>
                </div>
            </div>
        </div>
    </section>
</body>

<div id="success-overlay">Your message has been sent successfully!</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const contactForm = document.getElementById('contact-form');
        const successOverlay = document.getElementById('success-overlay');
        const submitBtn = document.getElementById('submit-btn');
        const btnContent = submitBtn.querySelector('.btn-content');
        const loadingSpinner = submitBtn.querySelector('.loading-spinner');

        contactForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Stop the default form submission (page reload)
            
            // Show loading state
            btnContent.style.display = 'none';
            loadingSpinner.style.display = 'flex';
            submitBtn.disabled = true;

            const formData = new FormData(contactForm);
            
            fetch(contactForm.action, {
                method: 'POST',
                body: formData,
                headers: {
                    // The 'X-CSRFToken' header is crucial for Django's security
                    'X-CSRFToken': '{{ csrf_token }}', 
                    'X-Requested-With': 'XMLHttpRequest' // Identifies this as an AJAX request
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    successOverlay.style.display = 'block'; // Show the success overlay
                    contactForm.reset(); // Clear the form
                    // Hide the overlay after 3 seconds
                    setTimeout(() => {
                        successOverlay.style.display = 'none';
                    }, 3000);
                } else {
                    // Handle server-side validation errors or other issues
                    alert('Error: ' + (data.message || 'Something went wrong.'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An unexpected error occurred. Please try again.');
            })
            .finally(() => {
                // Restore button to its original state
                btnContent.style.display = 'flex';
                loadingSpinner.style.display = 'none';
                submitBtn.disabled = false;
            });
        });
    });
</script>

{% endblock content %}